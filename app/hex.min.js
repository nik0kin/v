!function(a,b){!function(a,b,c){function d(){}function e(a){for(var b=0,c=arguments.length;c>b;b++){var d=arguments[b];if(d)for(var e in d)i.call(d,e)&&(a[e]=d[e])}return a}var f=a.hex={version:"0.1"},g=Array.prototype.join,h=Array.prototype.slice,i=Object.prototype.hasOwnProperty;f.extend=e,e(f,{create:function(a){if(!a)throw"no parent supplied";var b=h.call(arguments,1);d.prototype=a;var f=new d;return b.length?(b.unshift(f),e.apply(c,b)):f},key:function(){return g.call(arguments,",")},log:function(){this.debug&&a.console&&console.log.apply(console,arguments)}})}(a,a.document),function(c){c.extend(c,{position:function(a){var b=a.offsetLeft,c=a.offsetTop;for(a=a.offsetParent;a;)b+=a.offsetLeft,c+=a.offsetTop,a=a.offsetParent;return{x:b,y:c}},size:function(a){return{x:a.offsetWidth,y:a.offsetHeight}},style:function(c,d){var e;return c.currentStyle?e=c.currentStyle[d]:a.getComputedStyle&&(e=b.defaultView.getComputedStyle(c,null).getPropertyValue(d)),e}})}(a.hex),function(c,d){var e=Array.prototype.slice,f={};c.extend(c,{evented:{addEvent:function(a,b){this.events||(this.events={});var c=this.events[a];return c===d&&(c=this.events[a]=[]),c[c.length]=b,this},trigger:function(a){if(!this.events||!this.events[a])return!1;for(var b=10,d=this.events[a],g=e.call(arguments,0),h=0,i=d.length,j=!1,k=g[0]=c.create(f,{type:a,preventDefault:function(){j=!0}}),l=[];i>h;)try{for(;i>h;)d[h++].apply(this,g)}catch(m){l[l.length]=m,setTimeout(function(){throw m},b++)}return{event:k,errors:l,prevented:j,args:g}},queue:function(){var a=this.eventqueue;a||(a=this.eventqueue=[]),a[a.length]=e.call(arguments,0)},fire:function(){var a=this.eventqueue;if(a&&a.length)for(;a.length;)this.trigger.apply(this,a.shift())}}});var g,h={getTarget:function(){var a=this.target||this.srcElement;return a?3===a.nodeType?a.parentNode:a:d},inside:function(a){var b=this.mousepos(),d=c.position(a),e=c.size(a);return b.x>d.x&&b.x<d.x+e.x&&b.y>d.y&&b.y<d.y+e.y},mousepos:function(a){var e,f=this.event,g=0,h=0;if(f.touches&&f.touches.length?(e=f.touches[0],g=e.pageX,h=e.pageY):f.changedTouches&&f.changedTouches.length?(e=f.changedTouches[0],g=e.pageX,h=e.pageY):f.pageX!==d&&f.pageY!==d?(g=f.pageX,h=f.pageY):f.clientX!==d&&f.clientY!==d&&(g=f.clientX+b.body.scrollLeft+b.documentElement.scrollLeft,h=f.clientY+b.body.scrollTop+b.documentElement.scrollTop),a){var i=c.position(a);g-=i.x,h-=i.y}return{x:g,y:h}},preventDefault:function(){var a=this.event;a.preventDefault?a.preventDefault():a.returnValue=!1},stopPropagation:function(){var a=this.event;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}};b.addEventListener?(g={remove:function(){return this.elem.removeEventListener(this.type,this.callback)}},c.extend(c,{addEvent:function(a,b,d){function e(b){var e=b;try{e=c.create(b)}catch(f){}return c.extend(e,h,{event:b}),d.call(a,e)}return a.addEventListener(b,e,!1),c.create(g,{callback:e,elem:a,handler:d,type:b})},removeEvent:function(a,b,c){a.removeEventListener(b,c,!1)}})):b.attachEvent&&(g={remove:function(){return this.elem.detachEvent("on"+this.type,this.callback)}},c.extend(c,{addEvent:function(b,d,e){function f(){var d=a.event;return e.call(b,c.extend({},d,h,{event:d}))}function i(){b.detachEvent("on"+d,f),a.detachEvent("onunload",i)}return b.attachEvent("on"+d,f),a.attachEvent("onunload",i),c.create(g,{callback:f,elem:b,handler:e,type:d})},removeEvent:function(a,b,c){a.detachEvent("on"+b,c)}}))}(a.hex),function(a,c){var d=a.create(a.evented,{defaults:{type:"hexagonal",tapthreshold:400},reorient:function(a,b){this.origin.x=+a,this.origin.y=+b,this.root.style.left=a+"px",this.root.style.top=b+"px",this.elem.style.backgroundPosition=a+"px "+b+"px"}});a.extend(a,{grid:function(e,f){function g(a){var b=a.inside(e),c=a.mousepos(e),d={x:c.x-m.origin.x,y:c.y-m.origin.y};if(o.panning){if(o.enabled&&b){var f=d.x-o.x,g=d.y-o.y;l.style.left=f+"px",l.style.top=g+"px",e.style.backgroundPosition=f+"px "+g+"px",m.trigger("panmove",c.x-o.x-2*m.origin.x,c.y-o.y-2*m.origin.y)}}else{var h=m.events.tileover,i=m.events.tileout,j=m.events.gridover,k=m.events.gridout;if(h||i||j||k){var p=m.translate(d.x,d.y);b&&n.x===p.x&&n.y===p.y||(i&&null!==n.x&&null!==n.y&&m.queue("tileout",n.x,n.y),!b&&k&&null!==n.x&&null!==n.y&&m.queue("gridout",n.x,n.y),b?(j&&null===n.x&&null===n.y&&m.queue("gridover",p.x,p.y),h&&m.queue("tileover",p.x,p.y),n.x=p.x,n.y=p.y):(n.x=null,n.y=null),m.fire())}}}function h(a){var b=a.event;if(a.inside(e)){var c=b.type,d=a.mousepos(e);if(("mouseup"===c||"mousedown"===c)&&a.preventDefault(),"touchstart"===c&&(!b.touches||b.touches.length<2)&&a.preventDefault(),o.panning||"mousedown"!==c&&"touchstart"!==c&&"MozTouchDown"!==c||(o.panning=!0,o.x=d.x-2*m.origin.x,o.y=d.y-2*m.origin.y,e.style.cursor="move",m.queue("panstart")),o.panning&&("mouseup"===c||"touchend"===c||"MozTouchUp"===c||"MozTouchRelease"===c)){var f=d.x-2*m.origin.x-o.x,g=d.y-2*m.origin.y-o.y;f=0>f?-f:f,g=0>g?-g:g,(f>m.tileWidth||g>m.tileHeight)&&(q=null),o.enabled&&(m.queue("panend",d.x-o.x-2*m.origin.x,d.y-o.y-2*m.origin.y),m.reorient(d.x-m.origin.x-o.x,d.y-m.origin.y-o.y)),o.enabled=!0,o.panning=!1,o.x=null,o.y=null,e.style.cursor=""}var h=m.events.tiledown,i=m.events.tileup,j=m.events.tileclick,k=m.events.tiletap;if(!(h||i||j||k))return void m.fire();var l={x:d.x-m.origin.x,y:d.y-m.origin.y},n=m.translate(l.x,l.y);if("mousedown"===c||"touchstart"===c||"MozTouchDown"===c){if(q=+new Date,h){m.fire();var r=m.trigger("tiledown",n.x,n.y);r&&r.prevented&&(o.enabled=!1)}p.x=n.x,p.y=n.y}else("mouseup"===c||"touchend"===c||"MozTouchUp"===c||"MozTouchRelease"===c)&&(i&&m.queue("tileup",n.x,n.y),p.x===n.x&&p.y===n.y&&(j&&m.queue("tileclick",n.x,n.y),k&&q&&+new Date-q<m.tapthreshold&&m.queue("tiletap",n.x,n.y)),p.x=null,p.y=null,q=null);m.fire()}}function i(a){o.panning&&(m.reorient(parseInt(l.style.left,10),parseInt(l.style.top,10)),o.panning=!1,o.x=null,o.y=null,e.style.cursor="",null===p.x||null===p.y||a.inside(e)||m.queue("gridout",p.x,p.y),p.x=null,p.y=null,n.x=null,n.y=null,q=null,m.fire())}function j(a){var b=a.event;if(!b.ctrlKey){var c=a.inside(e),d=b.detail?-1*b.detail:.025*b.wheelDelta,f=d>0?1:0>d?-1:0;if(c&&f)if(a.preventDefault(),b.wheelDeltaX||b.axis&&b.axis===b.HORIZONTAL_AXIS){var g=m.tileWidth*f;m.queue("panstart"),m.queue("panmove",g,0),m.queue("panend",g,0),m.reorient(m.origin.x+g,m.origin.y)}else{var h=m.tileHeight*f;m.queue("panstart"),m.queue("panmove",0,h),m.queue("panend",0,h),m.reorient(m.origin.x,m.origin.y+h)}}}if(!e||1!==e.nodeType)throw"no DOM element supplied";if(f=a.extend({},d.defaults,f),a.grid[f.type]===c)throw"hex.grid."+f.type+" does not exist";var k=a.style(e,"position");"relative"!==k&&"absolute"!==k&&(e.style.position="relative"),"hidden"!==a.style(e,"overflow")&&(e.style.overflow="hidden");var l=b.createElement("div");l.style.position="absolute",l.style.left="0px",l.style.top="0px",l.style.overflow="visible",e.appendChild(l);var m=a.create(d,{events:{},origin:{x:0,y:0}},a.grid[f.type],f,{elem:e,root:l}),n={x:null,y:null},o={enabled:!0,panning:!1,x:null,y:null};a.addEvent(e,"mousemove",g),a.addEvent(e,"mouseover",g),a.addEvent(e,"mouseout",g),a.addEvent(e,"touchmove",g),a.addEvent(e,"touchstart",g),a.addEvent(e,"touchend",g),a.addEvent(e,"MozTouchDown",g),a.addEvent(e,"MozTouchMove",g),a.addEvent(e,"MozTouchUp",g),a.addEvent(e,"MozTouchRelease",g);var p={x:null,y:null},q=null;return a.addEvent(e,"mousedown",h),a.addEvent(e,"mouseup",h),a.addEvent(e,"touchstart",h),a.addEvent(e,"touchend",h),a.addEvent(e,"MozTouchDown",g),a.addEvent(e,"MozTouchUp",g),a.addEvent(e,"MozTouchRelease",g),a.addEvent(b,"mouseup",i),a.addEvent(b,"touchend",i),a.addEvent(b,"gesturestart",i),a.addEvent(b,"gesturechange",i),a.addEvent(b,"gestureend",i),a.addEvent(b,"MozTouchUp",i),a.addEvent(b,"MozTouchRelease",i),a.addEvent(e,"mousewheel",j),a.addEvent(e,"DOMMouseScroll",j),m.init&&m.init(),m}})}(a.hex),function(a){var b=Math.floor;a.grid.hexagonal={quadrant:function(a,c){var d=this.tileWidth,e=this.tileHeight,f=b((a-.25*d)/(.75*d)),g=b(c/e);return{x:f,y:g}},screenpos:function(a,b){var c=.75*this.tileWidth,d=this.tileHeight,e=a*c,f=-b*d-a*d*.5;return{x:e,y:f}},tileHeight:42,tileWidth:48,translate:function(a,b){var c,d,e=.5*this.tileWidth,f=.5*e,g=3*f,h=this.tileHeight,i=.5*h,j=i/f,k=this.quadrant(a,b),l=k.x,m=k.y,n=(a-f)%g,o=b%h;if(0>n&&(n+=g),0>o&&(o+=h),n-=e,l%2){if(c=l,d=.5*(1-l)-m-(o>i?1:0),0>=n||o==i)return{x:c,y:d};if(i>o&&o>i-n*j)return{x:c+1,y:d-1};if(o>i&&i+n*j>o)return{x:c+1,y:d}}else{if(c=l,d=.5*-l-m,0>=n||o==i)return{x:c,y:d};if(i>o&&n*j>o)return{x:c+1,y:d};if(o>i&&o>h-n*j)return{x:c+1,y:d-1}}return{x:c,y:d}}}}(a.hex),function(a){var b=Math.floor;a.grid.hexagonal_horizontal={quadrant:function(a,c){var d=this.tileWidth,e=this.tileHeight,f=b(a/d),g=b((c-.25*e)/(.75*e));return{x:f,y:g}},screenpos:function(a,b){var c=this.tileWidth,d=.75*this.tileHeight,e=-a*c-b*c*.5,f=b*d;return{x:e,y:f}},tileHeight:48,tileWidth:42,translate:function(a,b){var c,d,e=.5*this.tileHeight,f=.5*e,g=3*f,h=this.tileWidth,i=.5*h,j=i/f,k=this.quadrant(a,b),l=k.x,m=k.y,n=(b-f)%g,o=a%h;if(0>n&&(n+=g),0>o&&(o+=h),n-=e,m%2){if(d=m,c=.5*(1-m)-l-(o>i?1:0),0>=n||o===i)return{x:c,y:d};if(i>o&&o>i-n*j)return{y:d+1,x:c-1};if(o>i&&i+n*j>o)return{y:d+1,x:c}}else{if(d=m,c=.5*-m-l,0>=n||o===i)return{x:c,y:d};if(i>o&&n*j>o)return{y:d+1,x:c};if(o>i&&o>h-n*j)return{y:d+1,x:c-1}}return{x:c,y:d}}}}(a.hex),function(a){var b=Math.ceil,c=Math.floor;a.grid.rectangular={screenpos:function(a,b){return{x:a*this.tileWidth,y:-b*this.tileHeight}},tileHeight:48,tileWidth:48,translate:function(a,d){return{x:c(a/this.tileWidth),y:b(-d/this.tileHeight)}}}}(a.hex),function(a){var b=Math.floor;a.grid.skew={e1:{x:21,y:-36},e2:{x:-21,y:-36},init:function(){var a=this.e1.x,b=this.e1.y,c=this.e2.x,d=this.e2.y;if(a*d===c*b)throw"incomputable coefficient";this.coefficient=1/(a*d-c*b);for(var e=[a,a+c,c],f=[b,b+d,d],g=0,h=0,i=0,j=0,k=0;3>k;k++)e[k]>g&&(g=e[k]),e[k]<h&&(h=e[k]),f[k]>i&&(i=f[k]),f[k]<j&&(j=f[k]);this.tileWidth=g-h,this.tileHeight=i-j,this.offset={x:-h,y:-j}},screenpos:function(a,b){return{x:a*this.e1.x+b*this.e2.x,y:a*this.e1.y+b*this.e2.y}},translate:function(a,c){var d=this.coefficient;return a-=this.offset.x,c-=this.offset.y,{x:b(d*(a*this.e2.y-c*this.e2.x)),y:b(d*(c*this.e1.x-a*this.e1.y))}}}}(a.hex),function(a){var b=Math.floor;a.grid.triangular={tileHeight:48,tileWidth:56,init:function(){var b=this.tileHeight,c=this.tileWidth;this.e1={x:c,y:0},this.e2={x:.5*c,y:-b},a.grid.skew.init.call(this),this.tileHeight=b,this.tileWidth=c},screenpos:function(b,c){return a.grid.skew.screenpos.call(this,.5*b,c)},translate:function(a,c){a-=this.offset.x,c-=this.offset.y;var d=this.coefficient,e=d*(a*this.e2.y-c*this.e2.x),f=d*(c*this.e1.x-a*this.e1.y),g=b(e),h=b(f),i=e+f-g-h>1?1:0;return{x:2*g+i,y:h}}}}(a.hex),function(a){var b=a.create(a.evented);a.extend(a,{region:function(c,d){if(!c)throw"no grid was supplied";if(d=a.extend({},d),"function"!=typeof d.inside)throw"options.inside is not a function";var e=a.create(b,d,{grid:c}),f=!1;c.addEvent("tileover",function(a,b,c){var d=e.inside(b,c);d!==f&&e.trigger(d?"regionover":"regionout",b,c),f=d}),c.addEvent("gridout",function(a,b,c){f&&e.trigger("regionout",b,c),f=!1});var g=!1;return c.addEvent("tiledown",function(a,b,c){var d=e.inside(b,c);d&&e.trigger("regiondown",b,c),g=d}),c.addEvent("tileup",function(a,b,c){e.inside(b,c)&&(e.trigger("regionup",b,c),g&&e.trigger("regionclick",b,c))}),e}})}(a.hex),function(c,d){var e={},f={defaults:{delay:100,repeat:!1},animate:function(b){function d(){if(m++,m>=j){if(!l)return void a.clearTimeout(e);m=0}g.style.left=-(i+m)*k+"px"}b=c.extend({},f.defaults,b);var e,g=this.elem,h=this.coords,i=h[0],j=(h[1],h[2]),k=this.sprite.spritemap.width,l=b.repeat,m=0;e=this.timeout=a.setInterval(d,b.delay)},stop:function(){a.clearTimeout(this.timeout)}},g={defaults:{},sprite:function(){var a=c.create(e,{spritemap:this}),d=a.base=b.createElement("div");d.className="sprite",c.extend(d.style,{position:"relative",overflow:"hidden",width:this.width+"px",height:this.height+"px"});for(var g=a.layers=[],h=0,i=arguments.length;i>h;h++){var j=arguments[h],k=this.map[j],l=k[0],m=k[1],n=b.createElement("div");g[h]=c.create(f,{type:j,elem:n,sprite:a,coords:k}),c.extend(n.style,{position:"absolute",width:this.mapwidth+"px",height:this.mapheight+"px",top:-m*this.height+"px",left:-l*this.width+"px",backgroundImage:"url('"+this.url+"')",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+this.url+"', sizingMethod='crop')"}),d.appendChild(n)}return a}};c.extend(c,{spritemap:function(a){if(a===d)throw"no options hash was supplied";a=c.extend({},g.defaults,a);var b=a.map,e=0,f=0;for(var h in b){var i=b[h];i[0]>e&&(e=i[0]),i[1]>f&&(f=i[1])}var j=c.create(g,{mapwidth:(e+1)*a.width,mapheight:(f+1)*a.height},a);return j}})}(a.hex)}(window,window.document);